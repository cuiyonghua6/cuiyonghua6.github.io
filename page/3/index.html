<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">






<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="No pain, no gain.">
<meta property="og:type" content="website">
<meta property="og:title" content="崔永华的个人网站">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="崔永华的个人网站">
<meta property="og:description" content="No pain, no gain.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="崔永华的个人网站">
<meta name="twitter:description" content="No pain, no gain.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title> 崔永华的个人网站 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">崔永华的个人网站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190226_文件操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190226_文件操作/" itemprop="url">
                  python文件操作
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-26T15:24:20+08:00">
                2019-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>常用文件：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">IGNORED_EXTENSIONS = [</span><br><span class="line">    <span class="comment"># 图片</span></span><br><span class="line">    <span class="string">'mng'</span>, <span class="string">'pct'</span>, <span class="string">'bmp'</span>, <span class="string">'gif'</span>, <span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'png'</span>, <span class="string">'pst'</span>, <span class="string">'psp'</span>, <span class="string">'tif'</span>,</span><br><span class="line">    <span class="string">'tiff'</span>, <span class="string">'ai'</span>, <span class="string">'drw'</span>, <span class="string">'dxf'</span>, <span class="string">'eps'</span>, <span class="string">'ps'</span>, <span class="string">'svg'</span>,</span><br><span class="line">    <span class="comment"># 音频</span></span><br><span class="line">    <span class="string">'mp3'</span>, <span class="string">'wma'</span>, <span class="string">'ogg'</span>, <span class="string">'wav'</span>, <span class="string">'ra'</span>, <span class="string">'aac'</span>, <span class="string">'mid'</span>, <span class="string">'au'</span>, <span class="string">'aiff'</span>,</span><br><span class="line">    <span class="comment"># 视频</span></span><br><span class="line">    <span class="string">'3gp'</span>, <span class="string">'asf'</span>, <span class="string">'asx'</span>, <span class="string">'avi'</span>, <span class="string">'mov'</span>, <span class="string">'mp4'</span>, <span class="string">'mpg'</span>, <span class="string">'qt'</span>, <span class="string">'rm'</span>, <span class="string">'swf'</span>, <span class="string">'wmv'</span>,</span><br><span class="line">    <span class="string">'m4a'</span>, <span class="string">'m4v'</span>, <span class="string">'flv'</span>,</span><br><span class="line">    <span class="comment"># 办公软件</span></span><br><span class="line">    <span class="string">'xls'</span>, <span class="string">'xlsx'</span>, <span class="string">'ppt'</span>, <span class="string">'pptx'</span>, <span class="string">'pps'</span>, <span class="string">'doc'</span>, <span class="string">'docx'</span>, <span class="string">'odt'</span>, <span class="string">'ods'</span>, <span class="string">'odg'</span>,</span><br><span class="line">    <span class="string">'odp'</span>,</span><br><span class="line">    <span class="comment"># 其它</span></span><br><span class="line">    <span class="string">'css'</span>, <span class="string">'pdf'</span>, <span class="string">'exe'</span>, <span class="string">'bin'</span>, <span class="string">'rss'</span>, <span class="string">'zip'</span>, <span class="string">'rar'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h4 id="文件的打开与关闭"><a href="#文件的打开与关闭" class="headerlink" title="文件的打开与关闭"></a>文件的打开与关闭</h4><p>在python，使用: open(文件名，访问模式) 函数，可以打开一个已经存在的文件，或者创建一个新文件</p>
<table>
<thead>
<tr>
<th>访问模式</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>r</td>
<td>以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>
</tr>
<tr>
<td>w</td>
<td>打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>a</td>
<td>打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>rb</td>
<td>以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。</td>
</tr>
<tr>
<td>wb</td>
<td>以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>ab</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>r+</td>
<td>打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>w+</td>
<td>打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>a+</td>
<td>打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>
</tr>
<tr>
<td>rb+</td>
<td>以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>wb+</td>
<td>以二进制格式打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>ab+</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>
</tr>
</tbody>
</table>
<h4 id="文件的重命名和删除"><a href="#文件的重命名和删除" class="headerlink" title="文件的重命名和删除"></a>文件的重命名和删除</h4><p>os模块中的rename()可以完成对文件的重命名操作：rename(需要修改的文件名, 新的文件名)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.rename(<span class="string">"test.py"</span>, <span class="string">"test1.py"</span>)</span><br></pre></td></tr></table></figure></p>
<p>os模块中的remove()可以完成对文件的删除操作:  remove(待删除的文件名)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.remove(<span class="string">"毕业论文.txt"</span>)</span><br></pre></td></tr></table></figure></p>
<h4 id="文件夹的相关操作"><a href="#文件夹的相关操作" class="headerlink" title="文件夹的相关操作"></a>文件夹的相关操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建文件夹</span></span><br><span class="line">os.mkdir(<span class="string">"张三"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 获取当前目录</span></span><br><span class="line">os.getcwd()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 改变默认目录</span></span><br><span class="line">os.chdir(<span class="string">"../"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 获取目录列表</span></span><br><span class="line">os.listdir(<span class="string">"./"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 删除文件夹</span></span><br><span class="line">os.rmdir(<span class="string">"张三"</span>)</span><br></pre></td></tr></table></figure>
<p>Python3 OS 文件/目录方法：<br>os 模块提供了非常丰富的方法用来处理文件和目录。常用的方法如下表所示：</p>
<p>os.access(path, mode) ：检验权限模式<br>os.chdir(path)：改变当前工作目录<br>os.chflags(path, flags)：设置路径的标记为数字标记。<br>os.chmod(path, mode)：更改权限<br>os.chown(path, uid, gid)：更改文件所有者<br>os.chroot(path)：改变当前进程的根目录<br>os.close(fd)：关闭文件描述符 fd<br>os.closerange(fd_low, fd_high)：关闭所有文件描述符，从 fd_low (包含) 到 fd_high (不包含), 错误会忽略<br>os.dup(fd)：复制文件描述符 fd<br>os.dup2(fd, fd2)：将一个文件描述符 fd 复制到另一个 fd2<br>os.fchdir(fd)：通过文件描述符改变当前工作目录<br>os.fchmod(fd, mode)：改变一个文件的访问权限，该文件由参数fd指定，参数mode是Unix下的文件访问权限。<br>os.fchown(fd, uid, gid)：修改一个文件的所有权，这个函数修改一个文件的用户ID和用户组ID，该文件由文件描述符fd指定。<br>os.fdatasync(fd)：强制将文件写入磁盘，该文件由文件描述符fd指定，但是不强制更新文件的状态信息。<br>os.fdopen(fd[, mode[, bufsize]])：通过文件描述符 fd 创建一个文件对象，并返回这个文件对象<br>os.fpathconf(fd, name)：返回一个打开的文件的系统配置信息。name为检索的系统配置的值，它也许是一个定义系统值的字符串，这些名字在很多标准中指定（POSIX.1, Unix 95, Unix 98, 和其它）。<br>os.fstat(fd)：返回文件描述符fd的状态，像stat()。<br>os.fstatvfs(fd)：返回包含文件描述符fd的文件的文件系统的信息，像 statvfs()<br>os.fsync(fd)：强制将文件描述符为fd的文件写入硬盘。<br>os.ftruncate(fd, length)：裁剪文件描述符fd对应的文件, 所以它最大不能超过文件大小。<br>os.getcwd()：返回当前工作目录<br>os.getcwdu()：返回一个当前工作目录的Unicode对象<br>os.isatty(fd)：如果文件描述符fd是打开的，同时与tty(-like)设备相连，则返回true, 否则False。<br>os.lchflags(path, flags)：设置路径的标记为数字标记，类似 chflags()，但是没有软链接<br>os.lchmod(path, mode)：修改连接文件权限<br>os.lchown(path, uid, gid)：更改文件所有者，类似 chown，但是不追踪链接。<br>os.link(src, dst)：创建硬链接，名为参数 dst，指向参数 src<br>os.listdir(path)：返回path指定的文件夹包含的文件或文件夹的名字的列表。<br>os.lseek(fd, pos, how)：设置文件描述符 fd当前位置为pos, how方式修改: SEEK_SET 或者 0 设置从文件开始的计算的pos; SEEK_CUR或者 1 则从当前位置计算; os.SEEK_END或者2则从文件尾部开始. 在unix，Windows中有效<br>os.lstat(path)：像stat(),但是没有软链接<br>os.major(device)：从原始的设备号中提取设备major号码 (使用stat中的st_dev或者st_rdev field)。<br>os.makedev(major, minor)：以major和minor设备号组成一个原始设备号<br>os.makedirs(path[, mode])：递归文件夹创建函数。像mkdir(), 但创建的所有intermediate-level文件夹需要包含子文件夹。<br>os.minor(device)：从原始的设备号中提取设备minor号码 (使用stat中的st_dev或者st_rdev field )。<br>os.mkdir(path[, mode])：以数字mode的mode创建一个名为path的文件夹.默认的 mode 是 0777 (八进制)。<br>os.mkfifo(path[, mode])：创建命名管道，mode 为数字，默认为 0666 (八进制)<br>os.mknod(filename[, mode=0600, device])：创建一个名为filename文件系统节点（文件，设备特别文件或者命名pipe）。<br>os.open(file, flags[, mode])：打开一个文件，并且设置需要的打开选项，mode参数是可选的<br>os.openpty()：打开一个新的伪终端对。返回 pty 和 tty的文件描述符。<br>os.pathconf(path, name)：返回相关文件的系统配置信息。<br>os.pipe()：创建一个管道. 返回一对文件描述符(r, w) 分别为读和写<br>os.popen(command[, mode[, bufsize]])：从一个 command 打开一个管道<br>os.read(fd, n)：从文件描述符 fd 中读取最多 n 个字节，返回包含读取字节的字符串，文件描述符 fd对应文件已达到结尾, 返回一个空字符串。<br>os.readlink(path)：返回软链接所指向的文件<br>os.remove(path)：删除路径为path的文件。如果path 是一个文件夹，将抛出OSError; 查看下面的rmdir()：删除一个 directory。<br>os.removedirs(path)：递归删除目录。<br>os.rename(src, dst)：重命名文件或目录，从 src 到 dst<br>os.renames(old, new)：递归地对目录进行更名，也可以对文件进行更名。<br>os.rmdir(path)：删除path指定的空目录，如果目录非空，则抛出一个OSError异常。<br>os.stat(path)：获取path指定的路径的信息，功能等同于C API中的stat()系统调用。<br>os.stat_float_times([newvalue])：决定stat_result是否以float对象显示时间戳<br>os.statvfs(path)：获取指定路径的文件系统统计信息<br>os.symlink(src, dst)：创建一个软链接<br>os.tcgetpgrp(fd)：返回与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组<br>os.tcsetpgrp(fd, pg)：设置与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组为pg。<br>os.tempnam([dir[, prefix]])：返回唯一的路径名用于创建临时文件。<br>os.tmpfile()：返回一个打开的模式为(w+b)的文件对象 .这文件对象没有文件夹入口，没有文件描述符，将会自动删除。<br>os.tmpnam()：为创建一个临时文件返回一个唯一的路径<br>os.ttyname(fd)：返回一个字符串，它表示与文件描述符fd 关联的终端设备。如果fd 没有与终端设备关联，则引发一个异常。<br>os.unlink(path)：删除文件路径<br>os.utime(path, times)：返回指定的path文件的访问和修改的时间。<br>os.walk(top[, topdown=True[, onerror=None[, followlinks=False]]])：输出在文件夹中的文件名通过在树中游走，向上或者向下。<br>os.write(fd, str)：写入字符串到文件描述符 fd中. 返回实际写入的字符串长度</p>
<h4 id="3-案例"><a href="#3-案例" class="headerlink" title="3. 案例"></a>3. 案例</h4><p>1、用python处理文本数据，并删除处理之后的数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 根据条件把一个文本分成两个文本</span></span><br><span class="line"><span class="comment"># with open(r'list_object.txt', 'r') as file:</span></span><br><span class="line"><span class="comment">#     lines = file.readlines()</span></span><br><span class="line"><span class="comment">#     for key_word in lines:</span></span><br><span class="line"><span class="comment">#         if key_word.startswith('files/cninfo_category_daily_update/'):</span></span><br><span class="line"><span class="comment">#             with open(r'zs_stock.txt', 'a', encoding='utf-8') as file:</span></span><br><span class="line"><span class="comment">#                 file.write(key_word)</span></span><br><span class="line"><span class="comment">#         else:</span></span><br><span class="line"><span class="comment">#             with open(r'zs_bond.txt', 'a', encoding='utf-8') as file:</span></span><br><span class="line"><span class="comment">#                 file.write(key_word)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理文本数据，并删除处理之后的数据</span></span><br><span class="line">kafka_list = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">r'files/zs_stock.txt'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    lines = file.readlines()</span><br><span class="line">    print(<span class="string">'读取文本行数：'</span>, len(lines))</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> lines[<span class="number">0</span>:<span class="number">5</span>]:</span><br><span class="line">        kafka_list.append(num)</span><br><span class="line">        lines.remove(num)</span><br><span class="line">    print(<span class="string">'kafka_list:'</span>, kafka_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">r'files/zs_stock.txt'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        print(<span class="string">'删除已传送jds路径之后文本行数：'</span>, len(lines))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> lines:</span><br><span class="line">            f.write(i)</span><br></pre></td></tr></table></figure></p>
<p>2、输入文件的名字，然后程序自动完成对文件进行备份<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line">oldFileName = input(<span class="string">"请输入要拷贝的文件名字:"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(oldFileName, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> oldFile:</span><br><span class="line">    <span class="comment"># 如果打开文件</span></span><br><span class="line">    <span class="keyword">if</span> oldFile:</span><br><span class="line">        <span class="comment"># 提取文件的后缀</span></span><br><span class="line">        fileFlagNum = oldFileName.rfind(<span class="string">'.'</span>)</span><br><span class="line">        <span class="keyword">if</span> fileFlagNum &gt; <span class="number">0</span>:</span><br><span class="line">            fileFlag = oldFileName[fileFlagNum:]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 组织新的文件名字</span></span><br><span class="line">        newFileName = oldFileName[:fileFlagNum] + <span class="string">'[复件]'</span> + fileFlag</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 创建新文件</span></span><br><span class="line">        <span class="keyword">with</span> open(newFileName, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> newFile:</span><br><span class="line">            <span class="comment"># 把旧文件中的数据，一行一行的进行复制到新文件中</span></span><br><span class="line">            <span class="keyword">for</span> lineContent <span class="keyword">in</span> oldFile.readlines():</span><br><span class="line">                newFile.write(lineContent)</span><br></pre></td></tr></table></figure></p>
<p>3、批量在文件名前加前缀</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">funFlag = <span class="number">1</span>  <span class="comment"># 1表示添加标志  2表示删除标志</span></span><br><span class="line">folderName = <span class="string">'./test_fo/'</span></span><br><span class="line"><span class="comment"># 获取指定路径的所有文件名字</span></span><br><span class="line">dirList = os.listdir(folderName)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历输出所有文件名字</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> dirList:</span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">if</span> funFlag == <span class="number">1</span>:  <span class="comment"># 增加前缀</span></span><br><span class="line">        newName = <span class="string">'[东哥出品]-'</span> + name</span><br><span class="line">    <span class="keyword">elif</span> funFlag == <span class="number">2</span>:  <span class="comment"># 去除前缀</span></span><br><span class="line">        num = len(<span class="string">'[东哥出品]-'</span>)</span><br><span class="line">        newName = name[num:]</span><br><span class="line">    print(newName)</span><br><span class="line"></span><br><span class="line">    os.rename(folderName + name, folderName + newName)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190225_进程和线程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190225_进程和线程/" itemprop="url">
                  python进程和线程
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-25T15:24:20+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>操作系统会为每一个进程分配独立的内存空间，的那这样会占用独立的资源，对系统的开销较大。一般情况下我们可以使用多线程来完成多任务的开发，一个进程中包含了多个线程，对系统的开销较小一个进程中至少有一个线程，默认的这个线程我们叫做主线程。</p>
<p>单线程模拟人脑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 敲键盘ing</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keyboard</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        print(<span class="string">"敲键盘ing..."</span>)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 点鼠标ing</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mouse</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        print(<span class="string">"点鼠标ing..."</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    keyboard()</span><br><span class="line">    mouse()</span><br></pre></td></tr></table></figure>
<p>多线程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 敲键盘ing</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keyboard</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        print(<span class="string">"敲键盘ing..."</span>)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 点鼠标ing</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mouse</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        print(<span class="string">"点鼠标ing..."</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 为了方便，我们使用两个线程分别执行 keyboard和 mouse任务</span></span><br><span class="line">    print(<span class="string">"开辟前，当前有%s个线程在活动,他们是%s"</span> %</span><br><span class="line">          (threading.active_count(), threading.enumerate()))</span><br><span class="line"></span><br><span class="line">    keyboard_thread = threading.Thread(target=keyboard)</span><br><span class="line">    mouse_thread = threading.Thread(target=mouse)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"开辟后，当前有%s个线程在活动,他们是%s"</span> %</span><br><span class="line">          (threading.active_count(), threading.enumerate()))</span><br><span class="line"></span><br><span class="line">    keyboard_thread.start()</span><br><span class="line">    mouse_thread.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"start后，当前有%s个线程在活动,他们是%s"</span> %</span><br><span class="line">          (threading.active_count(), threading.enumerate()))</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 使用完毕</span></span><br><span class="line">    print(<span class="string">"play over"</span>)</span><br></pre></td></tr></table></figure>
<p>========================================<br>（wiki陶喵）</p>
<h4 id="坑no-1-类成员变量加锁保护"><a href="#坑no-1-类成员变量加锁保护" class="headerlink" title="坑no. 1 类成员变量加锁保护"></a>坑no. 1 类成员变量加锁保护</h4><p>在并发程序中，一个重要的需要注意的点是程序的可重入性 <a href="https://blog.csdn.net/vincent040/article/details/50978979" target="_blank" rel="noopener">https://blog.csdn.net/vincent040/article/details/50978979</a><br>以下以一个例子来介绍。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding : utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">lock = threading.Lock()</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">my_model</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">                self.weights = <span class="number">1</span></span><br><span class="line">                self.mid_data = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,input_data)</span>:</span></span><br><span class="line">                self.mid_data = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">                        i+<span class="number">1</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000000</span>):</span><br><span class="line">                        self.mid_data += (self.weights + input_data)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">                        i+<span class="number">1</span></span><br><span class="line">                result = self.mid_data</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">m = my_model()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/zero",methods=["GET"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zero</span><span class="params">()</span>:</span></span><br><span class="line">        res = m.predict(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> str(res)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/one",methods=["GET"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one</span><span class="params">()</span>:</span></span><br><span class="line">        res = m.predict(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> str(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">        app.run( host = <span class="string">"0.0.0.0"</span>, port = <span class="number">9865</span> )</span><br></pre></td></tr></table></figure></p>
<p>如上，这个程序看似没有什么问题。在连续访问下，能得到正确结果，但是当出现高并发的访问的时候，程序的结果就不可预知了。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(torch36) zhujinyi@gpuserver010:/data/nfs/wrk<span class="number">-4.1</span><span class="number">.0</span>$ wrk -t <span class="number">4</span> -c <span class="number">128</span> -d <span class="number">60</span>s -s test_m2.lua http://localhost:<span class="number">9865</span>/one</span><br><span class="line">Running <span class="number">1</span>m test @ http://localhost:<span class="number">9865</span>/one</span><br><span class="line">  <span class="number">4</span> threads <span class="keyword">and</span> <span class="number">128</span> connections</span><br><span class="line"><span class="number">953822</span></span><br><span class="line"><span class="number">3185088</span></span><br><span class="line"><span class="number">2847474</span></span><br><span class="line"><span class="number">2940568</span></span><br><span class="line"><span class="number">713724</span></span><br><span class="line"><span class="number">3103776</span></span><br><span class="line"><span class="number">2987122</span></span><br><span class="line"><span class="number">3380356</span></span><br><span class="line"><span class="number">105864</span></span><br><span class="line"><span class="number">3818912</span></span><br><span class="line"><span class="number">148244</span></span><br><span class="line"><span class="number">1301280</span></span><br><span class="line"><span class="number">1555600</span></span><br><span class="line"><span class="number">1495616</span></span><br><span class="line"><span class="number">4196668</span></span><br><span class="line"><span class="number">686306</span></span><br><span class="line"><span class="number">4317080</span></span><br><span class="line"><span class="number">729890</span></span><br><span class="line"><span class="number">909054</span></span><br></pre></td></tr></table></figure></p>
<p>这种情况下，常用的解决办法是加锁保护共享数据，界定临界区。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># encoding : utf-8</span><br><span class="line"></span><br><span class="line">from flask import Flask</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">lock = threading.Lock()</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">class my_model():</span><br><span class="line">        def __init__(self):</span><br><span class="line">                self.weights = 1</span><br><span class="line">                self.mid_data = 0</span><br><span class="line"></span><br><span class="line">        def predict(self,input_data):</span><br><span class="line">                lock.acquire()</span><br><span class="line">                self.mid_data = 0</span><br><span class="line">                for i in range(1000):</span><br><span class="line">                        i+1</span><br><span class="line">                for i in range(1000000):</span><br><span class="line">                        self.mid_data += (self.weights + input_data)</span><br><span class="line">                for i in range(1000):</span><br><span class="line">                        i+1</span><br><span class="line">                result = self.mid_data</span><br><span class="line">                lock.release()</span><br><span class="line">                return result</span><br><span class="line"></span><br><span class="line">m = my_model()</span><br><span class="line"></span><br><span class="line">@app.route(&quot;/zero&quot;,methods=[&quot;GET&quot;])</span><br><span class="line">def zero():</span><br><span class="line">        res = m.predict(0)</span><br><span class="line">        return str(res)</span><br><span class="line"></span><br><span class="line">@app.route(&quot;/one&quot;,methods=[&quot;GET&quot;])</span><br><span class="line">def one():</span><br><span class="line">        res = m.predict(1)</span><br><span class="line">        return str(res)</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">        app.run( host = &quot;0.0.0.0&quot;, port = 9865 )</span><br></pre></td></tr></table></figure></p>
<p>这样可以得到正确的结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(torch36) zhujinyi@gpuserver010:/data/nfs/wrk-4.1.0$ wrk -t 4 -c 128 -d 60s -s test_m2.lua http://localhost:9865/one</span><br><span class="line">Running 1m test @ http://localhost:9865/one</span><br><span class="line">  4 threads and 128 connections</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br><span class="line">2000000</span><br></pre></td></tr></table></figure></p>
<p>当然，大粒度的锁会严重影响程序的性能，不推荐把锁加到函数级别，另一种可以得到正确结果的方案是用更多的空间。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class my_model():</span><br><span class="line">        def __init__(self):</span><br><span class="line">                self.weights = 1</span><br><span class="line">                self.mid_data = 0</span><br><span class="line"></span><br><span class="line">        def predict(self,input_data):</span><br><span class="line">                tmp_data = 0</span><br><span class="line">                for i in range(1000):</span><br><span class="line">                        i+1</span><br><span class="line">                for i in range(1000000):</span><br><span class="line">                        tmp_data += (self.weights + input_data)</span><br><span class="line">                for i in range(1000):</span><br><span class="line">                        i+1</span><br><span class="line">                result = tmp_data</span><br><span class="line">                return result</span><br></pre></td></tr></table></figure></p>
<p>这样写也可以得到正确结果。</p>
<h4 id="同时起5个进程"><a href="#同时起5个进程" class="headerlink" title="同时起5个进程"></a>同时起5个进程</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">(num)</span>:</span></span><br><span class="line">    print(<span class="string">f'hello: <span class="subst">&#123;num&#125;</span>'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">works</span><span class="params">(func, tasknum)</span>:</span></span><br><span class="line">    proc_record = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(tasknum):</span><br><span class="line">        p = Process(target=func, args=(i,))</span><br><span class="line">        p.start()</span><br><span class="line">        proc_record.append(p)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> proc_record:</span><br><span class="line">        p.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">        tasknum = <span class="number">5</span></span><br><span class="line">        works(task, tasknum)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190223_python正则表达式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190223_python正则表达式/" itemprop="url">
                  python正则表达式
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T15:24:20+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">mystr=<span class="string">"""&lt;span class=\"search_yx_tj\"&gt;</span></span><br><span class="line"><span class="string">        共&lt;em&gt;5830&lt;/em&gt;个职位满足条件</span></span><br><span class="line"><span class="string">    &lt;/span&gt;"""</span></span><br><span class="line">restr = <span class="string">"&lt;em&gt;(\\d+)&lt;/em&gt;"</span>  <span class="comment"># 正则表达式，（）只要括号内的数据</span></span><br><span class="line">regex = re.compile(restr, re.IGNORECASE)</span><br><span class="line">mylist = regex.findall(mystr)</span><br><span class="line">print(mylist)  <span class="comment"># ['5830']</span></span><br><span class="line">print(mylist[<span class="number">0</span>])  <span class="comment"># 5830</span></span><br></pre></td></tr></table></figure>
<h4 id="python正则案例"><a href="#python正则案例" class="headerlink" title="python正则案例"></a>python正则案例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">m = re.match(<span class="string">r'(\w+) (\w+)(?P&lt;sign&gt;.*)'</span>, <span class="string">'hello world!'</span>)</span><br><span class="line">print(m)</span><br><span class="line">print(<span class="string">"@@@@@@@@m.string:"</span>, m.string)</span><br><span class="line">print(<span class="string">"m.re:"</span>, m.re)</span><br><span class="line">print(<span class="string">"m.pos:"</span>, m.pos)</span><br><span class="line">print(<span class="string">"m.endpos:"</span>, m.endpos)</span><br><span class="line">print(<span class="string">"m.lastindex:"</span>, m.lastindex)</span><br><span class="line">print(<span class="string">"m.lastgroup:"</span>, m.lastgroup)</span><br><span class="line">print(<span class="string">"m.group(1,2):"</span>, m.group(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">print(<span class="string">"m.groups():"</span>, m.groups())</span><br><span class="line">print(<span class="string">"m.groupdict():"</span>, m.groupdict())</span><br><span class="line">print(<span class="string">"m.start(2):"</span>, m.start(<span class="number">2</span>))</span><br><span class="line">print(<span class="string">"m.end(2):"</span>, m.end(<span class="number">2</span>))</span><br><span class="line">print(<span class="string">"m.span(2):"</span>, m.span(<span class="number">2</span>))</span><br><span class="line">print(<span class="string">r"m.expand(r'\2 \1\3'):"</span>, m.expand(<span class="string">r'\2 \1\3'</span>))</span><br><span class="line"></span><br><span class="line">p = re.compile(<span class="string">r'(\w+) (\w+)(?P&lt;sign&gt;.*)'</span>, re.DOTALL)</span><br><span class="line">print(<span class="string">"--------p.pattern:"</span>, p.pattern)</span><br><span class="line">print(<span class="string">"p.flags:"</span>, p.flags)</span><br><span class="line">print(<span class="string">"p.groups:"</span>, p.groups)</span><br><span class="line">print(<span class="string">"p.groupindex:"</span>, p.groupindex)</span><br><span class="line"></span><br><span class="line">line = <span class="string">"Cats are smarter than dogs"</span></span><br><span class="line">matchObj = re.match(<span class="string">r'(.*) are (.*?) .*'</span>, line, re.M | re.I).group(<span class="number">2</span>)</span><br><span class="line">print(matchObj)</span><br><span class="line"></span><br><span class="line">inputStr = <span class="string">"hello crifan, nihao crifan"</span>;</span><br><span class="line">replacedStr = re.sub(<span class="string">r"hello (\w+), nihao \1"</span>, <span class="string">"crifanli"</span>, inputStr)</span><br><span class="line">print(<span class="string">"%%%%%%%%%%replacedStr="</span>, replacedStr)  <span class="comment"># crifanli</span></span><br></pre></td></tr></table></figure>
<p>执行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;_sre.SRE_Match object; span=(0, 12), match=&apos;hello world!&apos;&gt;</span><br><span class="line">@@@@@@@@m.string: hello world!</span><br><span class="line">m.re: re.compile(&apos;(\\w+) (\\w+)(?P&lt;sign&gt;.*)&apos;)</span><br><span class="line">m.pos: 0</span><br><span class="line">m.endpos: 12</span><br><span class="line">m.lastindex: 3</span><br><span class="line">m.lastgroup: sign</span><br><span class="line">m.group(1,2): (&apos;hello&apos;, &apos;world&apos;)</span><br><span class="line">m.groups(): (&apos;hello&apos;, &apos;world&apos;, &apos;!&apos;)</span><br><span class="line">m.groupdict(): &#123;&apos;sign&apos;: &apos;!&apos;&#125;</span><br><span class="line">m.start(2): 6</span><br><span class="line">m.end(2): 11</span><br><span class="line">m.span(2): (6, 11)</span><br><span class="line">m.expand(r&apos;\2 \1\3&apos;): world hello!</span><br><span class="line">--------p.pattern: (\w+) (\w+)(?P&lt;sign&gt;.*)</span><br><span class="line">p.flags: 48</span><br><span class="line">p.groups: 3</span><br><span class="line">p.groupindex: &#123;&apos;sign&apos;: 3&#125;</span><br><span class="line">smarter</span><br><span class="line">%%%%%%%%%%replacedStr= crifanli</span><br></pre></td></tr></table></figure></p>
<p>正则表达式之数字：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">数字：^[<span class="number">0</span><span class="number">-9</span>]*$</span><br><span class="line">n位的数字：^\d&#123;n&#125;$</span><br><span class="line">至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">零和非零开头的数字：^(<span class="number">0</span>|[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$</span><br><span class="line">非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">非零的负整数：^\-[<span class="number">1</span><span class="number">-9</span>][]<span class="number">0</span><span class="number">-9</span><span class="string">"*$ 或 ^-[1-9]\d*$</span></span><br><span class="line"><span class="string">非负整数：^\d+$ 或 ^[1-9]\d*|0$</span></span><br><span class="line"><span class="string">非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span></span><br><span class="line"><span class="string">非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span></span><br><span class="line"><span class="string">非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span></span><br><span class="line"><span class="string">正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span></span><br><span class="line"><span class="string">负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span></span><br><span class="line"><span class="string">浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span></span><br></pre></td></tr></table></figure></p>
<p>正则表达式在线生成工具: <a href="https://www.w3cschool.cn/tools/index?name=create_reg" target="_blank" rel="noopener">https://www.w3cschool.cn/tools/index?name=create_reg</a></p>
<h4 id="常见正则表达式"><a href="#常见正则表达式" class="headerlink" title="常见正则表达式"></a>常见正则表达式</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">一、校验数字的表达式</span><br><span class="line"></span><br><span class="line">数字：^[<span class="number">0</span><span class="number">-9</span>]*$</span><br><span class="line"></span><br><span class="line">n位的数字：^\d&#123;n&#125;$</span><br><span class="line"></span><br><span class="line">至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line"></span><br><span class="line">m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line"></span><br><span class="line">零和非零开头的数字：^(<span class="number">0</span>|[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$</span><br><span class="line"></span><br><span class="line">非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">带1-2位小数的正数或负数：^(-)?\d+(.\d&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">正数、负数、和小数：^(-|+)?\d+(.\d+)?$</span><br><span class="line"></span><br><span class="line">有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line"></span><br><span class="line">有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line"></span><br><span class="line">非零的正整数：^[1-9]\d$ 或 ^([1-9][0-9])&#123;1,3&#125;$ 或 ^+?[1-9][0-9]*$</span><br><span class="line"></span><br><span class="line">非零的负整数：^-[<span class="number">1</span><span class="number">-9</span>][]<span class="number">0</span><span class="number">-9</span>″$ 或 ^-[<span class="number">1</span><span class="number">-9</span>]\d$</span><br><span class="line"></span><br><span class="line">非负整数：^\d+$ 或 ^[<span class="number">1</span><span class="number">-9</span>]\d*|<span class="number">0</span>$</span><br><span class="line"></span><br><span class="line">非正整数：^-[<span class="number">1</span><span class="number">-9</span>]\d*|<span class="number">0</span>$ 或 ^((-\d+)|(<span class="number">0</span>+))$</span><br><span class="line"></span><br><span class="line">非负浮点数：^\d+(.\d+)?$ 或 ^[1-9]\d.\d|0.\d[1-9]\d|0?.0+|0$</span><br><span class="line"></span><br><span class="line">非正浮点数：^((-\d+(.\d+)?)|(0+(.0+)?))$ 或 ^(-([1-9]\d.\d|0.\d[1-9]\d))|0?.0+|0$</span><br><span class="line"></span><br><span class="line">正浮点数：^[<span class="number">1</span><span class="number">-9</span>]\d.\d|<span class="number">0.</span>\d[<span class="number">1</span><span class="number">-9</span>]\d$ 或 ^(([<span class="number">0</span><span class="number">-9</span>]+.[<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>])|([<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>].[<span class="number">0</span><span class="number">-9</span>]+)|([<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]))$</span><br><span class="line"></span><br><span class="line">负浮点数：^-([<span class="number">1</span><span class="number">-9</span>]\d.\d|<span class="number">0.</span>\d[<span class="number">1</span><span class="number">-9</span>]\d)$ 或 ^(-(([<span class="number">0</span><span class="number">-9</span>]+.[<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>])|([<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>].[<span class="number">0</span><span class="number">-9</span>]+)|([<span class="number">0</span><span class="number">-9</span>][<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>])))$</span><br><span class="line"></span><br><span class="line">浮点数：^(-?\d+)(.\d+)?$ 或 ^-?([1-9]\d.\d|0.\d[1-9]\d|0?.0+|0)$</span><br><span class="line"></span><br><span class="line">二、校验字符的表达式</span><br><span class="line"></span><br><span class="line">汉字：^[\u4e00-\u9fa5]&#123;<span class="number">0</span>,&#125;$</span><br><span class="line"></span><br><span class="line">英文和数字：^[A-Za-z0<span class="number">-9</span>]+$ 或 ^[A-Za-z0<span class="number">-9</span>]&#123;<span class="number">4</span>,<span class="number">40</span>&#125;$</span><br><span class="line"></span><br><span class="line">长度为<span class="number">3</span><span class="number">-20</span>的所有字符：^.&#123;<span class="number">3</span>,<span class="number">20</span>&#125;$</span><br><span class="line"></span><br><span class="line">由<span class="number">26</span>个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line"></span><br><span class="line">由<span class="number">26</span>个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line"></span><br><span class="line">由<span class="number">26</span>个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line"></span><br><span class="line">由数字和<span class="number">26</span>个英文字母组成的字符串：^[A-Za-z0<span class="number">-9</span>]+$</span><br><span class="line"></span><br><span class="line">由数字、<span class="number">26</span>个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;<span class="number">3</span>,<span class="number">20</span>&#125;$</span><br><span class="line"></span><br><span class="line">中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0<span class="number">-9</span>_]+$</span><br><span class="line"></span><br><span class="line">中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0<span class="number">-9</span>]+$ 或 ^[\u4E00-\u9FA5A-Za-z0<span class="number">-9</span>]&#123;<span class="number">2</span>,<span class="number">20</span>&#125;$</span><br><span class="line"></span><br><span class="line">可以输入含有^%&amp;’,;=?$\”等字符：[^%&amp;',;=?$\x22]+</span><br><span class="line"></span><br><span class="line">禁止输入含有~的字符：[^~\x22]+</span><br><span class="line"></span><br><span class="line">三、特殊需求表达式</span><br><span class="line"></span><br><span class="line">Email地址：^\w+([-+.]\w+)@\w+([-.]\w+).\w+([-.]\w+)*$</span><br><span class="line"></span><br><span class="line">域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span><br><span class="line"></span><br><span class="line">InternetURL：[a-zA-z]+://[^\s] 或 ^http://([\w-]+.)+[\w-]+(/[\w-./?%&amp;=])?$</span><br><span class="line"></span><br><span class="line">手机号码：^(<span class="number">13</span>[<span class="number">0</span><span class="number">-9</span>]|<span class="number">14</span>[<span class="number">5</span>|<span class="number">7</span>]|<span class="number">15</span>[<span class="number">0</span>|<span class="number">1</span>|<span class="number">2</span>|<span class="number">3</span>|<span class="number">5</span>|<span class="number">6</span>|<span class="number">7</span>|<span class="number">8</span>|<span class="number">9</span>]|<span class="number">18</span>[<span class="number">0</span>|<span class="number">1</span>|<span class="number">2</span>|<span class="number">3</span>|<span class="number">5</span>|<span class="number">6</span>|<span class="number">7</span>|<span class="number">8</span>|<span class="number">9</span>])\d&#123;<span class="number">8</span>&#125;$</span><br><span class="line"></span><br><span class="line">电话号码(“XXX-XXXXXXX”、”XXXX-XXXXXXXX”、”XXX-XXXXXXX”、”XXX-XXXXXXXX”、”XXXXXXX”和”XXXXXXXX)：^($$\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$</span><br><span class="line"></span><br><span class="line">国内电话号码(<span class="number">0511</span><span class="number">-4405222</span>、<span class="number">021</span><span class="number">-87888822</span>)：\d&#123;<span class="number">3</span>&#125;-\d&#123;<span class="number">8</span>&#125;|\d&#123;<span class="number">4</span>&#125;-\d&#123;<span class="number">7</span>&#125;</span><br><span class="line"></span><br><span class="line">身份证号(<span class="number">15</span>位、<span class="number">18</span>位数字)：^\d&#123;<span class="number">15</span>&#125;|\d&#123;<span class="number">18</span>&#125;$</span><br><span class="line"></span><br><span class="line">短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line"></span><br><span class="line">帐号是否合法(字母开头，允许<span class="number">5</span><span class="number">-16</span>字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0<span class="number">-9</span>_]&#123;<span class="number">4</span>,<span class="number">15</span>&#125;$</span><br><span class="line"></span><br><span class="line">密码(以字母开头，长度在<span class="number">6</span>~<span class="number">18</span>之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;<span class="number">5</span>,<span class="number">17</span>&#125;$</span><br><span class="line"></span><br><span class="line">强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.\d)(?=.[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line"></span><br><span class="line">日期格式：^\d&#123;<span class="number">4</span>&#125;-\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;-\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line">一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line"></span><br><span class="line">一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</span><br><span class="line"></span><br><span class="line">钱的输入格式：</span><br><span class="line"></span><br><span class="line">有四种钱的表示形式我们可以接受:”<span class="number">10000.00</span>″ 和 “<span class="number">10</span>,<span class="number">000.00</span>″, 和没有 “分” 的 “<span class="number">10000</span>″ 和 “<span class="number">10</span>,<span class="number">000</span>″：^[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*$</span><br><span class="line"></span><br><span class="line">这表示任意一个不以<span class="number">0</span>开头的数字，但是，这也意味着一个字符”<span class="number">0</span>″不通过，所以我们采用下面的形式：^(<span class="number">0</span>|[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$</span><br><span class="line"></span><br><span class="line">一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</span><br><span class="line"></span><br><span class="line">这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉，因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</span><br><span class="line"></span><br><span class="line">必须说明的是，小数点后面至少应该有1位数，所以”10.”是不通过的，但是 “10″ 和 “10.2″ 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line"></span><br><span class="line">这样我们规定小数点后面必须有两位，如果你认为太苛刻了，可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">这样就允许用户只写一位小数。下面我们该考虑数字中的逗号了，我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">1到3个数字，后面跟着任意个 逗号+3个数字，逗号成为可选，而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line"></span><br><span class="line">备注：这就是最终结果了，别忘了”+”可以用”*”替代。如果你觉得空字符串也可以接受的话(奇怪，为什么?)最后，别忘了在用函数时去掉去掉那个反斜杠，一般的错误都在这里</span><br><span class="line"></span><br><span class="line">xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\.[x|X][m|M][l|L]$</span><br><span class="line"></span><br><span class="line">中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line"></span><br><span class="line">双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计<span class="number">2</span>，ASCII字符计<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">空白行的正则表达式：\n\s*\r (可以用来删除空白行)</span><br><span class="line"></span><br><span class="line">HTML标记的正则表达式：&lt;(\S?)[^&gt;]&gt;.?|&lt;.? /&gt; (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line"></span><br><span class="line">首尾空白字符的正则表达式：^\s|\s$或(^\s)|(\s$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line"></span><br><span class="line">腾讯QQ号：[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">4</span>,&#125; (腾讯QQ号从<span class="number">10000</span>开始)</span><br><span class="line"></span><br><span class="line">中国邮政编码：[1-9]\d&#123;5&#125;(?!\d) (中国邮政编码为6位数字)</span><br><span class="line"></span><br><span class="line">IP地址：\d+.\d+.\d+.\d+ (提取IP地址时有用)</span><br><span class="line"></span><br><span class="line">IP地址：((?:(?:25[0-5]|2[0-4]\d|[01]?\d?\d)\.)&#123;3&#125;(?:25[0-5]|2[0-4]\d|[01]?\d?\d))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190222_时间处理汇总/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190222_时间处理汇总/" itemprop="url">
                  python时间处理汇总
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-22T15:24:20+08:00">
                2019-02-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-datetime"><a href="#1-datetime" class="headerlink" title="1. datetime"></a>1. datetime</h4><p>datetime是Python处理日期和时间的标准库。</p>
<p>datetime表示的时间需要时区信息才能确定一个特定的时间，否则只能视为本地时间。</p>
<p>如果要存储datetime，最佳方法是将其转换为timestamp再存储，因为timestamp的值与时区完全无关。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta, timezone</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 获取当前日期和时间和指定日期和时间</span></span><br><span class="line">now = datetime.now()  <span class="comment"># 获取当前datetime</span></span><br><span class="line">print(now, type(now))</span><br><span class="line">dt = datetime(<span class="number">2019</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>)  <span class="comment"># 用指定日期时间创建datetime</span></span><br><span class="line">print(dt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. datetime转换为timestamp</span></span><br><span class="line">dt_stamp = dt.timestamp()</span><br><span class="line">print(dt_stamp)</span><br><span class="line"><span class="comment"># timestamp转换为datetime</span></span><br><span class="line">print(datetime.fromtimestamp(dt_stamp))</span><br><span class="line">print(datetime.utcfromtimestamp(dt_stamp))  <span class="comment"># UTC时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. str转换为datetime</span></span><br><span class="line">cday = datetime.strptime(<span class="string">'2019-6-1 18:19:59'</span>, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">print(cday)</span><br><span class="line"><span class="comment"># datetime转换为str</span></span><br><span class="line">print(now.strftime(<span class="string">'%a, %b %d %H:%M'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. datetime加减</span></span><br><span class="line">ten_hour = now + timedelta(hours=<span class="number">2</span>)</span><br><span class="line">print(ten_hour)</span><br><span class="line">print(now - timedelta(days=<span class="number">1</span>))</span><br><span class="line">print(now + timedelta(days=<span class="number">2</span>, hours=<span class="number">12</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 本地时间转换为UTC时间</span></span><br><span class="line"><span class="comment"># 北京时间是UTC+8:00时区的时间，而UTC时间指UTC+0:00时区的时间</span></span><br><span class="line">tz_utc_8 = timezone(timedelta(hours=<span class="number">8</span>)) <span class="comment"># 创建时区UTC+8:00</span></span><br><span class="line">dt = now.replace(tzinfo=tz_utc_8) <span class="comment"># 强制设置为UTC+8:00</span></span><br><span class="line">print(dt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 时区转换</span></span><br><span class="line"><span class="comment"># 可以先通过utcnow()拿到当前的UTC时间，再转换为任意时区的时间：</span></span><br><span class="line">utc_dt = datetime.utcnow().replace(tzinfo=timezone.utc)</span><br><span class="line">print(utc_dt)</span><br><span class="line"><span class="comment"># astimezone()将转换时区为北京时间:</span></span><br><span class="line">bj_dt = utc_dt.astimezone(timezone(timedelta(hours=<span class="number">8</span>)))</span><br><span class="line">print(bj_dt)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1095</span>, <span class="number">1</span>, <span class="number">-1</span>):  <span class="comment">#</span></span><br><span class="line">    start_date = <span class="string">'&#123;:%Y-%m-%d&#125;'</span>.format(datetime.date.today() - datetime.timedelta(days=i))</span><br><span class="line">    end_date = <span class="string">'&#123;:%Y-%m-%d&#125;'</span>.format(datetime.date.today() - datetime.timedelta(days=i<span class="number">-1</span>))</span><br><span class="line">    duration = <span class="string">'&#123;&#125; ~ &#123;&#125;'</span>.format(start_date, end_date)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(start_date)</span><br><span class="line">    print(end_date)</span><br><span class="line">    print(duration)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">date1 = datetime.datetime(<span class="number">2012</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">00</span>, <span class="number">00</span>, <span class="number">00</span>)</span><br><span class="line">timestamp = time.mktime(date1.timetuple())</span><br><span class="line">print(<span class="string">'格式化的时间转成时间戳：'</span>, timestamp)</span><br></pre></td></tr></table></figure>
<h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><p>假设你获取了用户输入的日期和时间如2015-1-21 9:01:30，以及一个时区信息如UTC+5:00，均是str，请编写一个函数将其转换为timestamp：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone, timedelta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_timestamp</span><span class="params">(dt_str, tz_str)</span>:</span></span><br><span class="line">    t = datetime.strptime(dt_str, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">    tz = re.match(<span class="string">r'\w&#123;3&#125;([\+\-]\d&#123;1,2&#125;)\:\d&#123;2&#125;'</span>, tz_str).group(<span class="number">1</span>)</span><br><span class="line">    tz = int(tz)</span><br><span class="line">    t_utc = t.replace(tzinfo=timezone(timedelta(hours=tz)))</span><br><span class="line">    print(t_utc.timestamp())</span><br><span class="line">    <span class="keyword">return</span> t_utc.timestamp()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = to_timestamp(<span class="string">'2015-6-1 08:10:30'</span>, <span class="string">'UTC+7:00'</span>)</span><br><span class="line"><span class="keyword">assert</span> t1 == <span class="number">1433121030.0</span>, t1</span><br><span class="line"></span><br><span class="line">t2 = to_timestamp(<span class="string">'2015-5-31 16:10:30'</span>, <span class="string">'UTC-09:00'</span>)</span><br><span class="line"><span class="keyword">assert</span> t2 == <span class="number">1433121030.0</span>, t2</span><br><span class="line"></span><br><span class="line">print(<span class="string">'ok'</span>)</span><br></pre></td></tr></table></figure></p>
<p>==========================</p>
<p><strong>案例1：打印昨天的时间：</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入 datetime 模块</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getYesterday</span><span class="params">()</span>:</span></span><br><span class="line">    today = datetime.date.today()</span><br><span class="line">    oneday = datetime.timedelta(days=<span class="number">1</span>)</span><br><span class="line">    yesterday = today - oneday</span><br><span class="line">    <span class="keyword">return</span> yesterday</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">print(getYesterday())  <span class="comment"># 2019-07-22</span></span><br></pre></td></tr></table></figure></p>
<p><strong>案例2：格式化时间</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 格式化成2019-07-23 11:45:39形式</span></span><br><span class="line">print(time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>, time.localtime()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化成Sat Mar 28 22:24:24 2016形式</span></span><br><span class="line">print(time.strftime(<span class="string">"%a %b %d %H:%M:%S %Y"</span>, time.localtime()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将格式字符串转换为时间戳</span></span><br><span class="line">a = <span class="string">"Sat Mar 28 22:24:24 2019"</span></span><br><span class="line">print(time.mktime(time.strptime(a, <span class="string">"%a %b %d %H:%M:%S %Y"</span>)))</span><br></pre></td></tr></table></figure></p>
<p>执行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20190723100548614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>案例3：输出某月的日历</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> calendar</span><br><span class="line"></span><br><span class="line">cal = calendar.month(<span class="number">2019</span>, <span class="number">7</span>)</span><br><span class="line">print(<span class="string">"以下输出2016年1月份的日历:"</span>)</span><br><span class="line">print(cal)</span><br></pre></td></tr></table></figure>
<p>执行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20190723100820174.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>案例4：将字符串的时间转换为时间戳</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">a1 = <span class="string">"2019-5-10 23:40:00"</span></span><br><span class="line"><span class="comment"># 先转换为时间数组</span></span><br><span class="line">timeArray = time.strptime(a1, <span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为时间戳</span></span><br><span class="line">timeStamp = int(time.mktime(timeArray))</span><br><span class="line">print(timeStamp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式转换 - 转为 /</span></span><br><span class="line">a2 = <span class="string">"2019-5-10 23:40:00"</span></span><br><span class="line"><span class="comment"># 先转换为时间数组,然后转换为其他格式</span></span><br><span class="line">timeArray = time.strptime(a2, <span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">otherStyleTime = time.strftime(<span class="string">"%Y/%m/%d %H:%M:%S"</span>, timeArray)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>
<p>执行结果如下图:<br><img src="https://img-blog.csdnimg.cn/20190723101529239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>案例5：获取几天前的时间</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先获得时间数组格式的日期</span></span><br><span class="line">threeDayAgo = (datetime.datetime.now() - datetime.timedelta(days=<span class="number">3</span>))</span><br><span class="line"><span class="comment"># 转换为时间戳</span></span><br><span class="line">timeStamp = int(time.mktime(threeDayAgo.timetuple()))</span><br><span class="line"><span class="comment"># 转换为其他字符串格式</span></span><br><span class="line">otherStyleTime = threeDayAgo.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>
<p>执行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20190723101936807.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>案例6：将时间戳转换为指定日期</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获得当前时间时间戳</span></span><br><span class="line">now = int(time.time())</span><br><span class="line"><span class="comment">#转换为其他日期格式,如:"%Y-%m-%d %H:%M:%S"</span></span><br><span class="line">timeArray = time.localtime(now)</span><br><span class="line">otherStyleTime = time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>, timeArray)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>
<p>执行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20190723102153414.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得当前时间</span></span><br><span class="line">now = datetime.datetime.now()</span><br><span class="line"><span class="comment"># 转换为指定的格式</span></span><br><span class="line">otherStyleTime = now.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>
<p>执行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20190723102254741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aV95b25naHVh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>指定时间戳：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">timeStamp = <span class="number">1556502800</span></span><br><span class="line">timeArray = time.localtime(timeStamp)</span><br><span class="line">otherStyleTime = time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>, timeArray)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">timeStamp = <span class="number">1557802800</span></span><br><span class="line">dateArray = datetime.datetime.utcfromtimestamp(timeStamp)</span><br><span class="line">otherStyleTime = dateArray.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</span><br><span class="line">print(otherStyleTime)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190221_模块和包以及各种库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190221_模块和包以及各种库/" itemprop="url">
                  python模块和包以及各种库
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-21T15:24:20+08:00">
                2019-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>模块(Module)：是一个 Python 文件，以 .py 结尾，包含了 Python 对象定义和Python语句。</p>
<p>如果一个文件中有<strong>all</strong>变量，那么也就意味着这个变量中的元素，不会被from xxx import *时导入</p>
<p>模块让你能够有逻辑地组织你的 Python 代码段。<br>把相关的代码分配到一个模块里能让你的代码更好用，更易懂。<br>模块能定义函数，类和变量，模块里也能包含可执行的代码。<br>包括：内置模块，自定义模块，第三方模块；<br>import 导入文件都做了哪些事？</p>
<p>以源文件为准产生一个名称空间<br>以刚刚产生的名称空间为准，执行源文件的代码<br>会在当前文件中定义一个名字，这个名字就是模块名，用来引用模块中的名字<br>模块的搜索路径：模块的查找顺序是：内存中已经加载的模块-&gt;内置模块（系统内置那些）-&gt;sys.path路径中包含的模块</p>
<p>1.安装的方式<br>找到模块的压缩包<br>解压<br>进入文件夹<br>执行命令： <code>python setup.py install</code><br>注意：<br>如果在install的时候，执行目录安装，可以使用：<code>python setup.py install --prefix=安装路径</code><br>2.模块的引入<br>在程序中，使用from import 即可完成对安装的模块使用</p>
<p>from 模块名 import 模块名或者*</p>
<p>包：包就是一个包含有<strong>init</strong>.py文件的文件夹。包的导入和导入模块类似，形式：import 包名，只不过想要使用包中的工具，则需要在包的 <strong>init </strong> 文件下导入此包的模块。</p>
<p><code>__init__.py</code>控制着包的导入行为</p>
<p><strong>init </strong>的作用：将此包下的模块进行导入，在其他地方调用这个包时，以便访问使用这个包的方法。</p>
<p>安装python模块已存在，可以指定安装的目录进行安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --target=d:\program\python\python37\lib\site-packages\twisted _win32stdio</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190220_面向对象编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190220_面向对象编程/" itemprop="url">
                  python面向对象编程
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-20T15:24:20+08:00">
                2019-02-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h4 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h4><p>面向对象(object-oriented ;简称: OO) 至今还没有统一的概念 我这里把它定义为: 按人们 认识客观世界的系统思维方式,采用基于对象(实体) 的概念建立模型,模拟客观世界分析、设 计、实现软件的办法。</p>
<p>面向对象编程(Object Oriented Programming-OOP) 是一种解决软件复用的设计和编程方法。 这种方法把软件系统中相近相似的操作逻辑和操作 应用数据、状态,以类的型式描述出来,以对象实例的形式在软件系统中复用,以达到提高软件开发效率的作用。</p>
<p>类(Class): 是一对相同特征或行为的事物的一个统称，是抽象的，不能直接使用它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。<br>属性：对象具有的特征（有什么），用来描述数据；<br>方法：对象具有的行为（能做什么），用来描述数据相关的操作；<br>作用：类相当于制造飞机的图纸，是一个模板，是负责创建对象的，它来进行创建的飞机就相当于对象；<br>类的抽象：拥有相同(或者类似)属性和行为的对象都可以抽像出一个类</p>
<p>对象：是由类创建出来的一个具体存在，可以直接使用。一个类创建出来的对象</p>
<p>类变量：类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。<br>数据成员：类变量或者实例变量用于处理类及其实例对象的相关的数据。<br>方法重写：如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。<br>局部变量：定义在方法中的变量，只作用于当前实例的类。<br>实例变量：在类的声明中，属性是用变量来表示的。这种变量就称为实例变量，是在类声明的内部但是在类的其他成员方法之外声明的。<br>继承：即一个派生类（derived class）继承基类（base class）的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。例如，有这样一个设计：一个Dog类型的对象派生自Animal类，这是模拟”是一个（is-a）”关系（例图，Dog是一个Animal）。<br>实例化：创建一个类的实例，类的具体对象。<br>对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。<br>案例：面向对象_扑克牌发牌程序 （Python经典编程案例）</p>
<p>接口：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> zope.interface <span class="keyword">import</span> Interface</span><br><span class="line"><span class="keyword">from</span> zope.interface.declarations <span class="keyword">import</span> implementer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义接口</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMiss</span><span class="params">(Interface)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">imissyouatlost</span><span class="params">(self, miss)</span>:</span></span><br><span class="line">        <span class="string">"""Say i miss you at lost to miss"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@implementer(MyMiss)  # 继承接口</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Miss</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">imissyouatlost</span><span class="params">(self, somebody)</span>:</span></span><br><span class="line">        <span class="string">"""Say i miss you at lost to somebody"""</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"i miss you at lost, &#123;&#125;!"</span>.format(somebody)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    z = Miss()</span><br><span class="line">    hi = z.imissyouatlost(<span class="string">'Zhangsan'</span>)</span><br><span class="line">    print(hi)</span><br></pre></td></tr></table></figure>
<p>对象：</p>
<ul>
<li>BMW = Car()，这样就产生了一个Car的实例对象，此时也可以通过实例对象BMW来访问属性或者方法;</li>
<li>第一次使用BMW.color = ‘黑色’表示给BMW这个对象添加属性，如果后面再次出现BMW.color = xxx表示对属性进行修改;</li>
<li>BMW是一个对象，它拥有属性（数据）和方法（函数）;</li>
<li>当创建一个对象时，就是用一个模子，来制造一个实物 </li>
</ul>
<p><img src="evernotecid://B1CD39FE-B044-413D-A086-0649DB3F0070/appyinxiangcom/26430792/ENResource/p412" alt="dcef2ef905cb935874ab9819beeb48e9.png"></p>
<p><strong>init</strong>方法</p>
<ol>
<li><strong>init</strong>()方法，在创建一个对象时默认被调用，不需要手动调用<br><strong>init</strong>(self)中，默认有1个参数名字为self，如果在创建对象时传递了2个实参，那么<strong>init</strong>(self)中出了self作为第一个形参外还需要2个形参，例如<strong>init</strong>(self,x,y)<br><strong>init</strong>(self)中的self参数，不需要开发者传递，python解释器会自动把当前的对象引用传递进去</li>
</ol>
<p>“魔法”方法</p>
<ul>
<li>在python中方法名如果是<strong>xxxx</strong>()的，那么就有特殊的功能，因此叫做“魔法”方法；</li>
<li>当使用print输出对象的时候，只要自己定义了<strong>str</strong>(self)方法，那么就会打印从在这个方法中return的数据</li>
</ul>
<p>self<br>所谓的self，可以理解为自己<br>可以把self当做C++中类里面的this指针一样理解，就是对象自身的意思<br>某个对象调用其方法时，python解释器会把这个对象作为第一个参数传递给self，所以开发者只需要传递后面的参数即可</p>
<p>保护对象属性：<br>如果有一个对象，当需要对其进行修改属性时，有2种方法：</p>
<ul>
<li>对象名.属性名 = 数据 —-&gt;直接修改</li>
<li>对象名.方法名() —-&gt;间接修改</li>
</ul>
<p>为了更好的保存属性安全，即不能随意修改，一般的处理方式为：</p>
<ul>
<li>将属性定义为私有属性</li>
<li>添加一个可以调用的方法，供调用</li>
</ul>
<p>Python中没有像C++中public和private这些关键字来区别公有属性和私有属性<br>它是以属性命名方式来区分，如果在属性名前面加了2个下划线’__’，则表明该属性是私有属性，否则为公有属性（方法也是一样，方法名前面加了2个下划线的话表示该方法是私有的，否则为公有的）。</p>
<p><code>__del__()</code>方法<br>创建对象后，python解释器默认调用<strong>init</strong>()方法；</p>
<p>当删除一个对象时，python解释器也会默认调用一个方法，这个方法为<strong>del</strong>()方法</p>
<p>继承<br>子类在继承的时候，在定义类时，小括号()中为父类的名字<br>父类的属性、方法，会被继承给子类</p>
<p>多态<br>多态的概念是应用于Java和C#这一类强类型语言中，而Python崇尚“鸭子类型”。<br>所谓多态：定义时的类型和运行时的类型不一样，此时就成为多态</p>
<p><strong>new</strong>和<strong>init</strong>的作用<br><strong>new</strong>至少要有一个参数cls，代表要实例化的类，此参数在实例化时由Python解释器自动提供</p>
<p><strong>new</strong>必须要有返回值，返回实例化出来的实例，这点在自己实现<strong>new</strong>时要特别注意，可以return父类<strong>new</strong>出来的实例，或者直接是object的<strong>new</strong>出来的实例</p>
<p><strong>init</strong>有一个参数self，就是这个<strong>new</strong>返回的实例，<strong>init</strong>在<strong>new</strong>的基础上可以完成一些其它初始化的动作，<strong>init</strong>不需要返回值</p>
<p>我们可以将类比作制造商，<strong>new</strong>方法就是前期的原材料购买环节，<strong>init</strong>方法就是在有原材料的基础上，加工，初始化商品环节</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190219_错误,测试和调试/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190219_错误,测试和调试/" itemprop="url">
                  python错误，测试和调试
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-19T15:24:20+08:00">
                2019-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>try语句处理异常，是这样做的：</p>
<p>首选，try子语句（try和except关键字之间的语句）会被执行。</p>
<p>如果没有异常发生，except 子句被略过。</p>
<p>如果有异常发生，try后面的其他语句就被跳过了，如果异常类型在except关键字后匹配，这个except子句被执行。</p>
<p>如果没有异常发生，else子句就会被执行。else的作用是它避免了捕获未保护的代码所发起的异常。</p>
<p>finally子语会在try子句执行完毕之前执行，不管是否发生或者不发生异常。当一个异常发生在try子句中却未被处理时（或者发生在except或者else子句中时），finally子句执行完后会再次抛出异常。</p>
<h4 id="实战：编写“角色扮演”游戏"><a href="#实战：编写“角色扮演”游戏" class="headerlink" title="实战：编写“角色扮演”游戏"></a>实战：编写“角色扮演”游戏</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 自定义异常类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MuchError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Victory</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义玩家与角色</span></span><br><span class="line">player = [<span class="string">'小黄'</span>, <span class="string">'小黑'</span>, <span class="string">'小白'</span>, <span class="string">'小红'</span>]</span><br><span class="line">role = [<span class="string">'女巫'</span>, <span class="string">'猎人'</span>, <span class="string">'狼人'</span>, <span class="string">'村民'</span>,</span><br><span class="line">        <span class="string">'守卫'</span>, <span class="string">'长老'</span>, <span class="string">'预言家'</span>, <span class="string">'白狼王'</span>]</span><br><span class="line"><span class="comment"># 将玩家与角色的顺序打乱并匹配</span></span><br><span class="line">player = random.sample(player, len(player))</span><br><span class="line">role = random.sample(role, len(player))</span><br><span class="line">print(<span class="string">'游戏中全部身份有：'</span> + <span class="string">'、'</span>.join(role))</span><br><span class="line">matching = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> range(len(player)):</span><br><span class="line">    matching[player[t]] = role[t]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 游戏逻辑</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    result, err = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> player:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            guess = input(<span class="string">'你认为'</span> + t + <span class="string">'的身份是：'</span>)</span><br><span class="line">            <span class="keyword">if</span> guess == matching[t]:</span><br><span class="line">                result += <span class="number">1</span></span><br><span class="line">                print(<span class="string">'你猜对了'</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                err += <span class="number">1</span></span><br><span class="line">                print(<span class="string">'猜错了，你还有'</span>+ str(<span class="number">1</span>-i) + <span class="string">'次机会'</span>)</span><br><span class="line">        <span class="keyword">if</span> err &gt; <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">raise</span> MuchError(<span class="string">'错误次数已超出5次，游戏结束'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> result == len(player):</span><br><span class="line">        <span class="keyword">raise</span> Victory(<span class="string">'恭喜你，全部猜对了'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> MuchError <span class="keyword">as</span> errInfo:</span><br><span class="line">    print(errInfo)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190218_函数式编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190218_函数式编程/" itemprop="url">
                  python函数式编程
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-18T15:24:20+08:00">
                2019-02-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h4 id="一-函数式编程介绍"><a href="#一-函数式编程介绍" class="headerlink" title="一. 函数式编程介绍"></a>一. 函数式编程介绍</h4><p>函数是Python内建支持的一种封装，我们通过把大段代码拆成函数，通过一层一层的函数调用，就可以把复杂任务分解成简单的任务，这种分解可以称之为面向过程的程序设计。函数就是面向过程的程序设计的基本单元。</p>
<p>而函数式编程（请注意多了一个“式”字）——Functional Programming，虽然也可以归结到面向过程的程序设计，但其思想更接近数学计算。</p>
<p>我们首先要搞明白计算机（Computer）和计算（Compute）的概念。</p>
<ul>
<li><p>在计算机的层次上，CPU执行的是加减乘除的指令代码，以及各种条件判断和跳转指令，所以，汇编语言是最贴近计算机的语言。</p>
</li>
<li><p>而计算则指数学意义上的计算，越是抽象的计算，离计算机硬件越远。</p>
</li>
</ul>
<p>函数式编程就是一种抽象程度很高的编程范式，纯粹的函数式编程语言编写的函数没有变量。</p>
<ul>
<li>函数式编程的一个特点就是，允许把函数本身作为参数传入另一个函数，还允许返回一个函数！</li>
</ul>
<p>Python对函数式编程提供部分支持。由于Python允许使用变量，因此，Python不是纯函数式编程语言。</p>
<h4 id="二-高阶函数"><a href="#二-高阶函数" class="headerlink" title="二. 高阶函数"></a>二. 高阶函数</h4><p>高阶函数英文叫Higher-order function。<br>把函数作为参数传入，这样的函数称为高阶函数，函数式编程就是指这种高度抽象的编程范式。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 变量可以指向函数</span></span><br><span class="line"><span class="comment"># 结论：函数本身也可以赋值给变量，即：变量可以指向函数。</span></span><br><span class="line">print(abs(<span class="number">-10</span>))  <span class="comment"># 10</span></span><br><span class="line">print(abs)  <span class="comment"># &lt;built-in function abs&gt;</span></span><br><span class="line">f = abs</span><br><span class="line">print(f)  <span class="comment"># &lt;built-in function abs&gt;</span></span><br><span class="line"><span class="comment"># 说明变量f现在已经指向了abs函数本身。直接调用abs()函数和调用变量f()完全相同。</span></span><br><span class="line">print(f(<span class="number">-10</span>))  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 函数名也是变量</span></span><br><span class="line"><span class="comment"># 由于abs函数实际上是定义在import builtins模块中的，</span></span><br><span class="line"><span class="comment"># 所以要让修改abs变量的指向在其它模块也生效(修改内置函数)，要用import builtins; builtins.abs = 10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 传入函数</span></span><br><span class="line"><span class="comment"># 既然变量可以指向函数，函数的参数能接收变量，那么一个函数就可以接收另一个函数作为参数，这种函数就称之为高阶函数。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y, f)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> f(x) + f(y)</span><br><span class="line"></span><br><span class="line">print(add(<span class="number">-5</span>, <span class="number">6</span>, abs))</span><br></pre></td></tr></table></figure></p>
<h5 id="1-map和reduce"><a href="#1-map和reduce" class="headerlink" title="1. map和reduce"></a>1. map和reduce</h5><p>map()函数接收两个参数，一个是函数，一个是Iterable，map将传入的函数依次作用到序列的每个元素，并把结果作为新的Iterator返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 比如我们有一个函数f(x)=x2，要把这个函数作用在一个list [1, 2, 3, 4, 5, 6, 7, 8, 9]上，就可以用map()实现如下：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x * x</span><br><span class="line"></span><br><span class="line">r = map(f, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">print(list(r))  <span class="comment"># [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br><span class="line"></span><br><span class="line">list1 = list(map(str, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]))</span><br><span class="line">print(list1)  <span class="comment"># ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># reduce把一个函数作用在一个序列[x1, x2, x3, ...]上，这个函数必须接收两个参数，</span></span><br><span class="line"><span class="comment"># reduce把结果继续和序列的下一个元素做累积计算</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果要把序列[1, 3, 5, 7, 9]变换成整数13579，reduce就可以派上用场：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">10</span> + y</span><br><span class="line"></span><br><span class="line">r1 = reduce(add, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br><span class="line">print(<span class="string">'reduce:---'</span>, r1)  <span class="comment"># 13579</span></span><br></pre></td></tr></table></figure>
<p>练习：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 练习1：利用map()函数，把用户输入的不规范的英文名字，变为首字母大写，其他小写的规范名字。</span></span><br><span class="line"><span class="comment"># 输入：['adam', 'LISA', 'barT']，输出：['Adam', 'Lisa', 'Bart']：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="comment"># 第一种方式</span></span><br><span class="line">    <span class="comment"># return name.capitalize()</span></span><br><span class="line">    <span class="comment"># 第二种方式</span></span><br><span class="line">    <span class="comment"># if not isinstance(name, str):</span></span><br><span class="line">    <span class="comment">#     raise TypeError('***参数不是字符串***')</span></span><br><span class="line">    <span class="comment"># name1 = name[0].upper()  # name的首字母大写（这里输出只有首字母）</span></span><br><span class="line">    <span class="comment"># name2 = name[1:].lower()  # name的除首字母以后全部小写（输出只有除首字母的部分）</span></span><br><span class="line">    <span class="comment"># name = name1 + name2  # 所以要连起来重新赋值给name</span></span><br><span class="line">    <span class="comment"># return name</span></span><br><span class="line">    <span class="comment"># 第三种方式</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(name, str):</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">'name input is not a string'</span>)</span><br><span class="line">    <span class="keyword">return</span> name[<span class="number">0</span>].upper() + name[<span class="number">1</span>:].lower()</span><br><span class="line"></span><br><span class="line">L1 = [<span class="string">'adam'</span>, <span class="string">'LISA'</span>, <span class="string">'barT'</span>]</span><br><span class="line">L2 = list(map(normalize, L1))</span><br><span class="line">print(L2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 练习2：Python提供的sum()函数可以接受一个list并求和，请编写一个prod()函数，可以接受一个list并利用reduce()求积：</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prod</span><span class="params">(L)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x*y, L)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'3 * 5 * 7 * 9 ='</span>, prod([<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]))</span><br><span class="line"><span class="keyword">if</span> prod([<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]) == <span class="number">945</span>:</span><br><span class="line">    print(<span class="string">'测试成功!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 练习3：利用map和reduce编写一个str2float函数，把字符串'123.456'转换成浮点数123.456：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2float</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">from</span> functools <span class="keyword">import</span> reduce  <span class="comment"># 调用reduce函数</span></span><br><span class="line">    DIGITS = &#123;<span class="string">'0'</span>: <span class="number">0</span>, <span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">2</span>, <span class="string">'3'</span>: <span class="number">3</span>, <span class="string">'4'</span>: <span class="number">4</span>, <span class="string">'5'</span>: <span class="number">5</span>, <span class="string">'6'</span>: <span class="number">6</span>, <span class="string">'7'</span>: <span class="number">7</span>, <span class="string">'8'</span>: <span class="number">8</span>, <span class="string">'9'</span>: <span class="number">9</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">char2num</span><span class="params">(s)</span>:</span>  <span class="comment"># 定义把数字字符元素转为数字元素的函数</span></span><br><span class="line">        <span class="keyword">return</span> DIGITS[s]</span><br><span class="line"></span><br><span class="line">    i = s.find(<span class="string">'.'</span>)  <span class="comment"># 找到'.'所在的索引位</span></span><br><span class="line">    L1 = reduce(<span class="keyword">lambda</span> x, y: x * <span class="number">10</span> + y, map(char2num, s[:i]))  <span class="comment"># 取'.'之前的元素计算</span></span><br><span class="line">    L2 = reduce(<span class="keyword">lambda</span> x, y: x / <span class="number">10</span> + y, map(char2num, s[:i:<span class="number">-1</span>])) / <span class="number">10</span>  <span class="comment"># 取'.'之后的元素计算</span></span><br><span class="line">    <span class="keyword">return</span> L1 + L2</span><br><span class="line"></span><br><span class="line">print(<span class="string">'str2float(\'123.456\') ='</span>, str2float(<span class="string">'123.456'</span>))</span><br><span class="line"><span class="keyword">if</span> abs(str2float(<span class="string">'123.456'</span>) - <span class="number">123.456</span>) &lt; <span class="number">0.00001</span>:</span><br><span class="line">    print(<span class="string">'测试成功!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br></pre></td></tr></table></figure></p>
<h5 id="2-filter"><a href="#2-filter" class="headerlink" title="2. filter"></a>2. filter</h5><p>Python内建的filter()函数用于过滤序列。<br>和map()类似，filter()也接收一个函数和一个序列。和map()不同的是，filter()把传入的函数依次作用于每个元素，然后根据返回值是True还是False决定保留还是丢弃该元素。<br>由于filter()使用了惰性计算，所以只有在取filter()结果的时候，才会真正筛选并每次返回下一个筛出的元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如，在一个list中，删掉偶数，只保留奇数，可以这么写：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">is_odd_test = list(filter(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>]))</span><br><span class="line">print(is_odd_test)  <span class="comment"># 结果: [1, 5, 9, 15]</span></span><br><span class="line"><span class="comment"># 注意到filter()函数返回的是一个Iterator，也就是一个惰性序列，所以要强迫filter()完成计算结果，需要用list()函数获得所有结果并返回list。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印1000以内的素数:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_odd_iter</span><span class="params">()</span>:</span>  <span class="comment"># 这是一个生成器，并且是一个无限序列</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = n + <span class="number">2</span></span><br><span class="line">        <span class="keyword">yield</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_not_divisible</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> x: x % n &gt; <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primes</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    it = _odd_iter()  <span class="comment"># 初始序列</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = next(it)  <span class="comment"># 返回序列的第一个数</span></span><br><span class="line">        <span class="keyword">yield</span> n</span><br><span class="line">        it = filter(_not_divisible(n), it)  <span class="comment"># 构造新序列</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> primes():</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">1000</span>:</span><br><span class="line">        print(n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h5 id="3-sorted"><a href="#3-sorted" class="headerlink" title="3. sorted"></a>3. sorted</h5><p>sorted()也是一个高阶函数。用sorted()排序的关键在于实现一个映射函数。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Python内置的sorted()函数就可以对list进行排序：</span></span><br><span class="line">print(sorted([<span class="number">36</span>, <span class="number">5</span>, <span class="number">-12</span>, <span class="number">9</span>, <span class="number">-21</span>]))  <span class="comment"># [-21, -12, 5, 9, 36]</span></span><br><span class="line"><span class="comment"># sorted()函数也是一个高阶函数，它还可以接收一个key函数来实现自定义的排序，例如按绝对值大小排序：</span></span><br><span class="line">print(sorted([<span class="number">36</span>, <span class="number">5</span>, <span class="number">-12</span>, <span class="number">9</span>, <span class="number">-21</span>], key=abs))  <span class="comment"># [5, 9, -12, -21, 36]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认情况下，对字符串排序，是按照ASCII的大小比较的，由于'Z' &lt; 'a'，结果，大写字母Z会排在小写字母a的前面。</span></span><br><span class="line">print(sorted([<span class="string">'bob'</span>, <span class="string">'about'</span>, <span class="string">'Zoo'</span>, <span class="string">'Credit'</span>]))  <span class="comment"># ['Credit', 'Zoo', 'about', 'bob']</span></span><br><span class="line"><span class="comment"># 忽略大小写来比较两个字符串，实际上就是先把字符串都变成大写（或者都变成小写），再比较。</span></span><br><span class="line">print(sorted([<span class="string">'bob'</span>, <span class="string">'about'</span>, <span class="string">'Zoo'</span>, <span class="string">'Credit'</span>], key=str.lower))  <span class="comment"># ['about', 'bob', 'Credit', 'Zoo']</span></span><br><span class="line"><span class="comment"># 要进行反向排序，不必改动key函数，可以传入第三个参数reverse=True：</span></span><br><span class="line">print(sorted([<span class="string">'bob'</span>, <span class="string">'about'</span>, <span class="string">'Zoo'</span>, <span class="string">'Credit'</span>], key=str.lower, reverse=<span class="literal">True</span>))  <span class="comment"># ['Zoo', 'Credit', 'bob', 'about']</span></span><br></pre></td></tr></table></figure></p>
<h4 id="二-返回函数"><a href="#二-返回函数" class="headerlink" title="二. 返回函数"></a>二. 返回函数</h4><p>函数作为返回值：一个函数可以返回一个计算结果，也可以返回一个函数。返回一个函数时，牢记该函数并未执行，返回函数中不要引用任何可能会变化的变量。</p>
<p>返回闭包时牢记一点：返回函数不要引用任何循环变量，或者后续会发生变化的变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">             <span class="keyword">return</span> i*i</span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line">print(f1(), f1)  <span class="comment"># 9 &lt;function count.&lt;locals&gt;.f at 0x000001CCF2376840&gt;</span></span><br><span class="line">print(f2(), f2)  <span class="comment"># 9 &lt;function count.&lt;locals&gt;.f at 0x000001CCF23768C8&gt;</span></span><br><span class="line">print(f3(), f3)  <span class="comment"># 9 &lt;function count.&lt;locals&gt;.f at 0x000001CCF2376950&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count1</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(j)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">g</span><span class="params">()</span>:</span></span><br><span class="line">            <span class="keyword">return</span> j*j</span><br><span class="line">        <span class="keyword">return</span> g</span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        fs.append(f(i)) <span class="comment"># f(i)立刻被执行，因此i的当前值被传入f()</span></span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f11, f22, f33 = count1()</span><br><span class="line">print(f11(), f11)  <span class="comment"># 1 &lt;function count1.&lt;locals&gt;.f.&lt;locals&gt;.g at 0x000001CCF2376AE8&gt;</span></span><br><span class="line">print(f22(), f22)  <span class="comment"># 4 &lt;function count1.&lt;locals&gt;.f.&lt;locals&gt;.g at 0x000001CCF2376B70&gt;</span></span><br><span class="line">print(f33(), f33)  <span class="comment"># 9 &lt;function count1.&lt;locals&gt;.f.&lt;locals&gt;.g at 0x000001CCF2376BF8&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="三-匿名函数"><a href="#三-匿名函数" class="headerlink" title="三. 匿名函数"></a>三. 匿名函数</h4><p>Python对匿名函数的支持有限，只有一些简单的情况下可以使用匿名函数。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 匿名函数lambda x: x * x实际上就是：def f(x): return x * x</span></span><br><span class="line">list1 = list(map(<span class="keyword">lambda</span> x: x * x, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]))</span><br><span class="line">print(list1)  <span class="comment"># [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同样，也可以把匿名函数作为返回值返回，比如：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span>: x * x + y * y</span><br><span class="line"></span><br><span class="line">print(build(<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure></p>
<h4 id="四-装饰器"><a href="#四-装饰器" class="headerlink" title="四. 装饰器"></a>四. 装饰器</h4><p>在面向对象（OOP）的设计模式中，decorator被称为装饰模式。<br>在代码运行期间动态增加功能的方式，称之为“装饰器”（Decorator）。<br>OOP的装饰模式需要通过继承和组合来实现，而Python除了能支持OOP的decorator外，直接从语法层次支持decorator。<br>Python的decorator可以用函数实现，也可以用类实现。decorator可以增强函数的功能，定义起来虽然有点复杂，但使用起来非常灵活和方便。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本质上，decorator就是一个返回函数的高阶函数。所以，我们要定义一个能打印日志的decorator，可以定义如下：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">        print(<span class="string">'call %s():'</span> % func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'2015-3-25'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now()</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(text)</span>:</span></span><br><span class="line">    <span class="string">"""不需要编写wrapper.__name__ = func.__name__这样的代码，Python内置的functools.wraps就是干这个事的，所以，一个完整的decorator的写法如下："""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">        @functools.wraps(func)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">            print(<span class="string">'%s %s():'</span> % (text, func.__name__))</span><br><span class="line">            <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log('execute')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'2015-3-25'</span>)</span><br><span class="line"></span><br><span class="line">now()</span><br></pre></td></tr></table></figure>
<h4 id="五-偏函数"><a href="#五-偏函数" class="headerlink" title="五. 偏函数"></a>五. 偏函数</h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190217_函数及其高级特性/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190217_函数及其高级特性/" itemprop="url">
                  python函数及其高级特性
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-17T15:24:20+08:00">
                2019-02-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>函数：把具有独立功能的代码块组织一个小模块，在需要的时候调用<br>返回值：就是程序中函数完成一件事情后，最后给调用者的结果</p>
<p>全局变量：在函数外边定义的变量，全局变量能够在所有的函数中进行访问；如果在函数中修改全局变量，那么就需要使用global进行声明，否则出错；如果全局变量的名字和局部变量的名字相同，那么使用的是局部变量的，小技巧强龙不压地头蛇<br>对于不可变类型的全局变量来说，因其指向的数据不能修改，所以不使用global时无法修改全局变量。对于可变类型的全局变量来说，因其指向的数据可以修改，所以不使用global时也可修改全局变量。</p>
<ul>
<li>定义函数时，需要确定函数名和参数个数；</li>
<li>如果有必要，可以先对参数的数据类型做检查；</li>
<li>函数体内部可以用return随时返回函数结果；</li>
<li>函数执行完毕也没有return语句时，自动return None;</li>
<li>函数可以同时返回多个值，但其实就是一个tuple。</li>
</ul>
<p>浅拷贝 copy(): 不拷贝子对象的内容，只拷贝子对象的引用；<br>深拷贝 deepcopy(): 会连子对象的内存也全部拷贝一份，对子对象的修改不会影响原对象。</p>
<p>LEGB规则：python查找名称时，查找顺序：local -&gt; enclosed -&gt; global -&gt; built in </p>
<ul>
<li>local: （局部）函数或者类的方法内部；</li>
<li>enclosed: （闭包）嵌套函数，在闭包作用域进行搜索，装饰器就是一种闭包；</li>
<li>global: （全局）模块中的全局变量；</li>
<li>build in : 内建命名空间，python为自己保留的特殊名称。</li>
</ul>
<p>Lambda函数：是一种比较小的匿名函数<br>规则：只允许包含一个表达式，计算结果就是函数的返回值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="keyword">lambda</span> a, b: a*b</span><br><span class="line">print(x(<span class="number">3</span>, <span class="number">6</span>))</span><br><span class="line">y = <span class="keyword">lambda</span> c: c*<span class="number">4</span></span><br><span class="line">print(y(<span class="number">6</span>))</span><br></pre></td></tr></table></figure></p>
<h4 id="参数处理"><a href="#参数处理" class="headerlink" title="参数处理"></a>参数处理</h4><p>定义时小括号中的参数，用来接收参数用的，称为 “形参”<br>调用时小括号中的参数，用来传递给函数用的，称为 “实参”</p>
<p>在Python中定义函数，可以用必选参数、默认参数、可变参数、关键字参数和命名关键字参数，这5种参数都可以组合使用。但是请注意，参数定义的顺序必须是：必选参数、默认参数、可变参数、命名关键字参数和关键字参数。使得函数定义出来的接口，不但能处理复杂的参数，还可以简化调用者的代码。</p>
<p>默认参数：要牢记一点：默认参数必须指向不变对象！<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enroll</span><span class="params">(name, gender, age=<span class="number">6</span>, city=<span class="string">'Beijing'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""可以把年龄和城市设为默认参数"""</span></span><br><span class="line">    print(<span class="string">'name:'</span>, name)</span><br><span class="line">    print(<span class="string">'gender:'</span>, gender)</span><br><span class="line">    print(<span class="string">'age:'</span>, age)</span><br><span class="line">    print(<span class="string">'city:'</span>, city)</span><br><span class="line"></span><br><span class="line">enroll(<span class="string">'Sarah'</span>, <span class="string">'F'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认参数一定要用不可变对象，如果是可变对象，程序运行时会有逻辑错误！</span></span><br><span class="line"><span class="comment"># 如果默认参数指向对象[]，每次调用该函数，如果改变了L的内容，则下次调用时，默认参数的内容就变了，不再是函数定义时的[]了。</span></span><br><span class="line"><span class="comment"># 这时可以用None这个不变对象来实现无论调用多少次，都不会有问题：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_end</span><span class="params">(L=None)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> L <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        L = []</span><br><span class="line">    L.append(<span class="string">'END'</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure></p>
<p>可变参数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如计算计算a^2 + b^2 + c^2 + ……。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(*numbers)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> numbers:</span><br><span class="line">        sum = sum + n * n</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line"></span><br><span class="line">print(calc(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># Python允许你在list或tuple前面加一个*号，把list或tuple的元素变成可变参数传进去</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">print(calc(*nums))  <span class="comment"># 这种写法相当有用，而且很常见。</span></span><br></pre></td></tr></table></figure></p>
<p>关键字参数：至于到底传入了哪些，就需要在函数内部通过kw检查，如：<code>if &#39;city&#39; in kw:</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, **kw)</span>:</span></span><br><span class="line">    <span class="string">"""kw获得的dict是extra的一份拷贝，对kw的改动不会影响到函数外的extra"""</span></span><br><span class="line">    print(<span class="string">'name:'</span>, name, <span class="string">'age:'</span>, age, <span class="string">'other:'</span>, kw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在调用该函数时，可以只传入必选参数：</span></span><br><span class="line">person(<span class="string">'Michael'</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变参数类似，也可以先组装出一个dict，然后，把该dict转换为关键字参数传进去</span></span><br><span class="line">extra = &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</span><br><span class="line">person(<span class="string">'Jack'</span>, <span class="number">24</span>, city=extra[<span class="string">'city'</span>], job=extra[<span class="string">'job'</span>])</span><br><span class="line"><span class="comment"># 当然，上面复杂的调用可以用简化的写法：</span></span><br><span class="line">person(<span class="string">'Jack'</span>, <span class="number">24</span>, **extra)</span><br></pre></td></tr></table></figure></p>
<p>命名关键字参数：是为了限制调用者可以传入的参数名，同时可以提供默认值。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命名关键字参数需要一个特殊分隔符*，*后面的参数被视为命名关键字参数。</span></span><br><span class="line"><span class="comment"># 缺少 *，city和job被视为位置参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person1</span><span class="params">(name, age, *, city, job)</span>:</span></span><br><span class="line">    print(name, age, city, job)</span><br><span class="line"><span class="comment"># 命名关键字参数必须传入参数名，这和位置参数不同。如果没有传入参数名，调用将报错</span></span><br><span class="line">person1(<span class="string">'Jack'</span>, <span class="number">24</span>, city=<span class="string">'Beijing'</span>, job=<span class="string">'Engineer'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果函数定义中已经有了一个可变参数，后面跟着的命名关键字参数就不再需要一个特殊分隔符*了：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person2</span><span class="params">(name, age, *args, city, job)</span>:</span></span><br><span class="line">    print(name, age, args, city, job)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于命名关键字参数city具有默认值，调用时，可不传入city参数：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person3</span><span class="params">(name, age, *, city=<span class="string">'Beijing'</span>, job)</span>:</span></span><br><span class="line">    print(name, age, city, job)</span><br><span class="line"></span><br><span class="line">person3(<span class="string">'Jack'</span>, <span class="number">24</span>, job=<span class="string">'Engineer'</span>)</span><br></pre></td></tr></table></figure></p>
<p>参数检查：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_abs</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="comment"># 数据类型检查可以用内置函数isinstance()实现：</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(x, (int, float)):</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">'bad operand type'</span>)</span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -x</span><br><span class="line"></span><br><span class="line">print(my_abs(<span class="number">5</span>))</span><br></pre></td></tr></table></figure></p>
<h4 id="递归函数"><a href="#递归函数" class="headerlink" title="递归函数"></a>递归函数</h4><p>递归函数：自己调用自己的函数；<br>包含两个部分：①终止条件；②递归步骤。<br>处理大数据时慎用，因为会创建大量函数对象，过量的消耗内存和运算能力。<br>理论上，所有的递归函数都可以写成循环的方式，但循环的逻辑不如递归清晰。</p>
<p>使用递归函数的优点是逻辑简单清晰，缺点是过深的调用会导致栈溢出。</p>
<p>举个例子，我们来计算阶乘n! = 1 x 2 x 3 x … x n，用函数fact(n)表示，可以看出：<code>fact(n) = n! = 1 x 2 x 3 x ... x (n-1) x n = (n-1)! x n = fact(n-1) x n</code>。所以，fact(n)可以表示为<code>n x fact(n-1)</code>，只有n=1时需要特殊处理。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n * fact(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fact(<span class="number">5</span>)</span><br></pre></td></tr></table></figure></p>
<p>使用递归函数需要注意防止栈溢出。在计算机中，函数调用是通过栈（stack）这种数据结构实现的，每当进入一个函数调用，栈就会加一层栈帧，每当函数返回，栈就会减一层栈帧。由于栈的大小不是无限的，所以，递归调用的次数过多，会导致栈溢出。可以试试fact(1000)。</p>
<p>解决递归调用栈溢出的方法是通过尾递归优化(通过尾递归防止栈溢出)，事实上尾递归和循环的效果是一样的，所以，把循环看成是一种特殊的尾递归函数也是可以的。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> fact_iter(n, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact_iter</span><span class="params">(num, product)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> product</span><br><span class="line">    <span class="keyword">return</span> fact_iter(num - <span class="number">1</span>, num * product)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fact_iter(<span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line">fact_iter(<span class="number">4</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure></p>
<p>尾递归调用时，如果做了优化，栈不会增长，因此，无论多少次调用也不会导致栈溢出。遗憾的是，大多数编程语言没有针对尾递归做优化，Python解释器也没有做优化，所以，即使把上面的fact(n)函数改成尾递归方式，也会导致栈溢出。</p>
<h4 id="函数高级特性"><a href="#函数高级特性" class="headerlink" title="函数高级特性"></a>函数高级特性</h4><p>函数高级特性：切片，迭代，生成器，迭代器</p>
<ol>
<li>切片：有了切片操作，很多地方循环就不再需要了。Python的切片非常灵活，一行代码就可以实现很多行循环才能完成的操作。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">L = [<span class="string">'Michael'</span>, <span class="string">'Sarah'</span>, <span class="string">'Tracy'</span>, <span class="string">'Bob'</span>, <span class="string">'Jack'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># L[0:3]表示，从索引0开始取，直到索引3为止，但不包括索引3。即索引0，1，2，正好是3个元素</span></span><br><span class="line">print(L[<span class="number">0</span>:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># Python支持L[-1]取倒数第一个元素，同样支持倒数切片,倒数第一个元素的索引是-1</span></span><br><span class="line">print(L[<span class="number">-2</span>:])</span><br><span class="line">print(L[<span class="number">-2</span>:<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">L1 = list(range(<span class="number">30</span>))</span><br><span class="line"><span class="comment"># 前10个数，每两个取一个：</span></span><br><span class="line">print(L1[:<span class="number">10</span>:<span class="number">2</span>])  <span class="comment"># [0, 2, 4, 6, 8]</span></span><br><span class="line"><span class="comment"># 所有数，每5个取一个：</span></span><br><span class="line">print(L1[::<span class="number">5</span>])  <span class="comment"># [0, 5, 10, 15, 20, 25]</span></span><br></pre></td></tr></table></figure>
<p>迭代：<br>迭代（Iteration）：如果给定一个list或tuple，我们可以通过for循环来遍历这个list或tuple，这种遍历我们称为迭代（Iteration）。</p>
<ul>
<li>只要是可迭代对象，无论有无下标，都可以迭代</li>
</ul>
<p>生成器: 如果列表元素可以按照某种算法推算出来，那我们是否可以在循环的过程中不断推算出后续的元素呢？这样就不必创建完整的list，从而节省大量的空间。在Python中，这种一边循环一边计算的机制，称为生成器：generator</p>
<p>generator是非常强大的工具，在Python中，可以简单地把列表生成式改成generator，也可以通过函数实现复杂逻辑的generator。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 第一种：创建生成器的方法很简单，只要把一个列表生成式的[]改成()</span></span><br><span class="line">L = [x * x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br><span class="line">print(L)  <span class="comment"># [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br><span class="line">g = (x * x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>))</span><br><span class="line">print(g)  <span class="comment"># &lt;generator object &lt;genexpr&gt; at 0x1022546d0&gt;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> g:</span><br><span class="line">    print(n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 斐波拉契数列（Fibonacci），除第一个和第二个数外，任意一个数都可由前两个数相加得到</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(max)</span>:</span></span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; max:</span><br><span class="line">        print(b)</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'done'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种：如果一个函数定义中包含yield关键字，那么这个函数就不再是一个普通函数，而是一个generator：</span></span><br><span class="line"><span class="comment"># 变成generator的函数，在每次调用next()的时候执行，遇到yield语句返回，再次执行时从上次返回的yield语句处继续执行。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib1</span><span class="params">(max)</span>:</span></span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; max:</span><br><span class="line">        <span class="keyword">yield</span> b  <span class="comment"># 只需要把print(b)改为yield b就可以了</span></span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'done'</span></span><br><span class="line"></span><br><span class="line">print(fib1(<span class="number">6</span>))</span><br></pre></td></tr></table></figure></p>
<p>迭代器：<br>我们已经知道，可以直接作用于for循环的数据类型有以下几种：</p>
<ul>
<li>一类是集合数据类型，如list、tuple、dict、set、str等；</li>
<li>一类是generator，包括生成器和带yield的generator function;</li>
<li>这些可以直接作用于for循环的对象统称为可迭代对象：Iterable;</li>
<li>可以被next()函数调用并不断返回下一个值的对象称为<strong>迭代器</strong>：Iterator</li>
<li>集合数据类型如list、dict、str等是Iterable但不是Iterator，不过可以通过iter()函数获得一个Iterator对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 可以使用isinstance()判断一个对象是否是Iterable对象：</span></span><br><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Iterable</span><br><span class="line">print(isinstance([], Iterable))  <span class="comment"># True</span></span><br><span class="line">print(isinstance(&#123;&#125;, Iterable))  <span class="comment"># True</span></span><br><span class="line">print(isinstance((x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)), Iterable))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以使用isinstance()判断一个对象是否是Iterator对象：</span></span><br><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Iterator</span><br><span class="line">print(isinstance((x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)), Iterator))  <span class="comment"># True</span></span><br><span class="line">print(isinstance([], Iterator))  <span class="comment"># False</span></span><br><span class="line">print(isinstance(&#123;&#125;, Iterator))  <span class="comment"># False</span></span><br><span class="line">print(isinstance(<span class="string">'abc'</span>, Iterator))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成器都是Iterator对象，但list、dict、str虽然是Iterable，却不是Iterator。</span></span><br><span class="line"><span class="comment"># 把list、dict、str等Iterable变成Iterator可以使用iter()函数：</span></span><br><span class="line">print(isinstance(iter([]), Iterator))  <span class="comment"># True</span></span><br><span class="line">print(isinstance(iter(<span class="string">'abc'</span>), Iterator))  <span class="comment"># True</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/python/python基础/20190216_控制语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔永华（Andy）">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="崔永华的个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/python/python基础/20190216_控制语句/" itemprop="url">
                  python控制语句
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-16T15:24:20+08:00">
                2019-02-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/python基础/" itemprop="url" rel="index">
                    <span itemprop="name">python基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>控制语句</p>
<p>注意：<br>代码的缩进格式很重要 建议4个空格来控制<br>根据逻辑值（True，Flase）判断程序的运行方向<br>Ture：表示非空的量（String，tuple元组 、list、set、dictonary），所有非零的数字，False：0，None 、空的量<br>逻辑表达式 可以包含 逻辑运算符 and or not</p>
<p>break的作用是提前结束循环;<br>continue的作用是提前结束本轮循环，并直接开始下一轮循环</p>
<h4 id="条件控制if"><a href="#条件控制if" class="headerlink" title="条件控制if:"></a>条件控制if:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只要x是非零数值、非空字符串、非空list等，就判断为True，否则为False</span></span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">    print(<span class="string">'True'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h4><p>Python中的循环语句有 for 和 while。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/uploads/avatar.png" alt="崔永华（Andy）">
          <p class="site-author-name" itemprop="name">崔永华（Andy）</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">51</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cuiyonghua6" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://blog.csdn.net/cui_yonghua" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-bandcamp"></i>
                  
                  CSDN
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/cuiyonghua" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weibo.com/cuiyonghua" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">崔永华（Andy）</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
